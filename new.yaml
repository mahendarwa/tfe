package gke.maintenance_window

default allow = false

# Define the expected maintenance start time (UTC) and duration
expected_start_time = "05:00"
expected_duration = "PT4H0M0S"  # ISO 8601 format: 4 hours

# Main policy rule
allow {
    input.kind == "Cluster"
    input.spec.maintenancePolicy.window.dailyMaintenanceWindow.startTime == expected_start_time
    input.spec.maintenancePolicy.window.dailyMaintenanceWindow.duration == expected_duration
}
