package wiz

default result = "pass"

deny[reason] {
  input.type == "CONTAINER_REGISTRY"
  some perm
  perm := input.properties.hasIAMAccessFromExternalSubscription[_]
  reason := sprintf("GAR is externally accessible with '%s' permission", [perm])
}

result := "fail" {
  deny[_]
}
