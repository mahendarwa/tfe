- name: Verify Secrets
  env:
    ARTIFACTORY_USER: ${{ secrets.ARTIFACTORY_USER }}
    ARTIFACTORY_PASS: ${{ secrets.ARTIFACTORY_PASS }}
  run: |
    if [[ -z "$ARTIFACTORY_USER" || -z "$ARTIFACTORY_PASS" ]]; then
      echo "One or more secrets are not set!"
      exit 1
    else
      echo "Secrets are successfully loaded."
    fi

    cd ddrgenerator
    export JAVA_HOME=/usr/local/jdk11
    chmod 755 gradlew
    ./gradlew clean build -x test

    docker kill ddrgenerator || true
    docker rm ddrgenerator || true
    docker image rm -f ddrgenerator || true

    cd /home/bambscm1/actions-runner/_work/bcc-patservice/bcc-patservice/ddrgenerator
    docker build -t ddrgenerator --file Dockerfile .

    cd /home/bambscm1/actions-runner/_work/bcc-patservice/bcc-patservice/cicd/docker-compose/qa/
    docker-compose -f docker-compose.primary.yml up -d
