sudo su
# Install Microsoft repo
curl https://packages.microsoft.com/config/rhel/7/prod.repo | tee /etc/yum.repos.d/msprod.repo

# Install ODBC driver
sudo yum install -y msodbcsql17 unixODBC unixODBC-devel


ls /opt/microsoft/msodbcsql17/lib64/
sudo yum remove msodbcsql17
sudo yum install msodbcsql17
====

import pyodbc

connection = None  # Initialize

connection_string = (
    r'DRIVER={ODBC Driver 17 for SQL Server};'
    r'SERVER=HSTNCMNSRIDQA02.hatshipping.inside;'
    r'Trusted_connection=yes;'
    r'TrustServerCertificate=yes;'
    r'DATABASE=Staging;'
    r'DOMAIN=INTERNAL;'
    r'UID=C8X6K9;'
    r'PWD=Dev2s@mpath;'
)

try:
    connection = pyodbc.connect(connection_string)
    cursor = connection.cursor()
    print("Connected to SQL Server")

    cursor.execute("SELECT @@version;")
    row = cursor.fetchone()
    print(f"SQL Server version: {row[0]}")

except pyodbc.Error as ex:
    print(ex)
    sqlstate = ex.args[0]
    if sqlstate == '28000':
        print("Invalid credentials")
    else:
        print("Connection error:", ex)

finally:
    if connection:
        cursor.close()
        connection.close()
        print("Connection closed")
