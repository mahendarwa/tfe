package wiz

default result = "pass"

paths := ["containers", "initContainers"]

# Fail if `securityContext.capabilities.add` is present and not empty
result = "fail" {
    some i, j
    input.object.spec[paths[i]][j].securityContext.capabilities.add
    count(input.object.spec[paths[i]][j].securityContext.capabilities.add) > 0
}

currentConfiguration := "'securityContext.capabilities.add' includes values beyond the allowed values"
expectedConfiguration := "'securityContext.capabilities.add' should be empty (`[]`) or absent"
