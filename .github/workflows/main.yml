name: Test SQL Server Connectivity

on:
  workflow_dispatch:

jobs:
  test-sql-server-connectivity:
    runs-on: self-hosted
    steps:
      - name: Test Ping to SQL Server
        shell: pwsh
        run: |
          $ServerName = "your-sql-server-name"
          Write-Host "Pinging SQL Server..."
          Test-Connection -ComputerName $ServerName -Count 4 -ErrorAction SilentlyContinue

      - name: Test Port 1433 (Default SQL Server Port)
        shell: pwsh
        run: |
          $ServerName = "your-sql-server-name"
          $Port = 1433
          Write-Host "Testing connectivity to SQL Server on port $Port..."
          $connection = Test-NetConnection -ComputerName $ServerName -Port $Port
          if ($connection.TcpTestSucceeded) {
              Write-Host "✅ SQL Server is reachable on port $Port!"
          } else {
              Write-Host "❌ Cannot reach SQL Server on port $Port!"
              exit 1
          }

      - name: Confirm workflow completed
        shell: pwsh
        run: Write-Host "✅ GitHub Actions Workflow Completed Successfully!"
