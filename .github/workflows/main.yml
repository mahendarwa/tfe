name: Merge Feature Branch to Develop

on:
  push:
    branches:
      - feature/test-develop

permissions:
  contents: write
  pull-requests: write

jobs:
  merge-to-develop:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Configure Git
        run: |
          git config --global user.email "balaji.seetharman@cignahealthcare.com"
          git config --global user.name "C8X6K9_Zilver"

      - name: Fetch and Merge Branch
        run: |
          git fetch origin develop
          git checkout develop
          git pull origin develop
          git merge --no-ff feature/test-develop -m "Auto-merging feature/test-develop into develop" --allow-unrelated-histories || {
            git merge --strategy-option ours feature/test-develop
            git commit -am "Auto-resolved merge conflicts using 'ours' strategy"
          }
          git push origin develop
        env:
          GIT_AUTHOR_NAME: "C8X6K9_Zilver"
          GIT_AUTHOR_EMAIL: "balaji.seetharman@cignahealthcare.com"
          GIT_COMMITTER_NAME: "C8X6K9_Zilver"
          GIT_COMMITTER_EMAIL: "balaji.seetharman@cignahealthcare.com"
